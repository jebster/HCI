/*

 JS Signals <http://millermedeiros.github.com/js-signals/>
 Released under the MIT license
 Author: Miller Medeiros
 Version: 0.7.4 - Build: 252 (2012/02/24 10:30 PM)
*/(function(e){function t(e,t,n,r,i){this._listener=t;this._isOnce=n;this.context=r;this._signal=e;this._priority=i||0}function n(e,t){if(typeof e!="function")throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}var r={VERSION:"0.7.4"};t.prototype={active:!0,params:null,execute:function(e){var t;this.active&&this._listener&&(e=this.params?this.params.concat(e):e,t=this._listener.apply(this.context,e),this._isOnce&&this.detach());return t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},getListener:function(){return this._listener},_destroy:function(){delete this._signal;delete this._listener;delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};r.Signal=function(){this._bindings=[];this._prevParams=null};r.Signal.prototype={memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(e,n,r,i){var s=this._indexOfListener(e,r);if(s!==-1){if(e=this._bindings[s],e.isOnce()!==n)throw Error("You cannot add"+(n?"":"Once")+"() then add"+(n?"Once":"")+"() the same listener without removing the relationship first.")}else e=new t(this,e,n,r,i),this._addBinding(e);this.memorize&&this._prevParams&&e.execute(this._prevParams);return e},_addBinding:function(e){var t=this._bindings.length;do--t;while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){for(var n=this._bindings.length,r;n--;)if(r=this._bindings[n],r._listener===e&&r.context===t)return n;return-1},has:function(e,t){return this._indexOfListener(e,t)!==-1},add:function(e,t,r){n(e,"add");return this._registerListener(e,!1,t,r)},addOnce:function(e,t,r){n(e,"addOnce");return this._registerListener(e,!0,t,r)},remove:function(e,t){n(e,"remove");var r=this._indexOfListener(e,t);r!==-1&&(this._bindings[r]._destroy(),this._bindings.splice(r,1));return e},removeAll:function(){for(var e=this._bindings.length;e--;)this._bindings[e]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(e){if(this.active){var t=Array.prototype.slice.call(arguments),n=this._bindings.length,r;this.memorize&&(this._prevParams=t);if(n){r=this._bindings.slice();this._shouldPropagate=!0;do n--;while(r[n]&&this._shouldPropagate&&r[n].execute(t)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};typeof define=="function"&&define.amd?define(r):typeof module!="undefined"&&module.exports?module.exports=r:e.signals=r})(this);